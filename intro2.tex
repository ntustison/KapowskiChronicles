\section{Introduction}

Imaging-based structural analysis of the brain plays a fundamental role
in identifying the relationship between cortical morphology, disease, and cognition.
Discriminative quantitative cortical measures have been demonstrated in conditional 
abnormalities such as 
Huntington's disease \citep{rosas2002,rosas2005,selemon2004}, 
schizophrenia \citep{nesvag2008}, bipolar disorder \cite{lyoo2006}, Alzheimer's disease and frontotemporal
dementia \citep{du2007,dickerson2009}, Parkinson's disease \citep{jubault2011}, Williams syndrome \citep{thompson2005},
multiple sclerosis \citep{ramasamy2009}, autism \citep{chung2005,hardan2006},
migraines \citep{dasilva2007}, chronic smoking \citep{kuhn2010}, alcoholism \citep{fortier2011},
cocaine addiction \citep{makris2008}, Tourette syndrome in children \citep{sowell2008},
scoliosis in
female adolescents \citep{wang2012}, 
early-onset blindness \citep{jiang2009},
chronic pancreatitis \citep{frokjaer2012},
obsessive-compulsive disorder \citep{shin2007}, ADHD \citep{almeida-montes2012}, obesity \citep{raji2010}, 
and heritable \citep{peterson2009}
and elderly \citep{ballmaier2004} depression.  Evidence of cortical thickness 
variation has also been found to be a function of age \citep{kochunov2011},
gender \citep{luders2006a}, untreated
male-to-female transsexuality \citep{luders2012},  handedness
\citep{luders2006,amunts2007}, intelligence \citep{shaw2006}, athletic
ability \citep{wei2011}, meditative practices \cite{lazar2005}, musical ability \citep{bermudez2009,foster2010}, 
tendency toward criminality \citep{raine2011}, 
childhood sexual abuse in adult females \citep{heim2013},
and Tetris-playing
ability in female adolescents \citep{haier2009}.  Additionally,
recent studies demonstrate structural 
connectivity relationships using cortical thickness measures
\citep{worsley2005,lerch2006,he2007,chen2008}.
Although these findings
are subject to debate and interpretation \citep{gernsbacher2007}, 
the availability of quantitative
computational methods for extracting such information
has proven invaluable for developing and refining fundamental 
neuroscience hypotheses.

Computational methods for analyzing the cortex may be 
broadly characterized as surface mesh-based or volumetric \citep{scott2009,clarkson2011}.  Representative of the former is the
FreeSurfer%
\footnote{
http://surfer.nmr.mgh.harvard.edu/
}
cortical modeling software package \citep{dale1999,fischl1999,fischl2000,fischl2002,fischl2004}
which owes its popularity to public availability, excellent documentation, 
good performance, and  integration with other toolkits, such as the extensive FMRIB software 
library (FSL) \citep{smith2004}.  Similar to other surface
approaches (e.g. \cite{davatzikos1996,magnotta1999,macdonald2000,kim2005}), the pial
and white matter surfaces from individual subject MR data are modeled with polygonal meshes  
which are then used to determine local cortical thickness values based on a specified correspondence between 
the surface models.

Image volumetric (or meshless) techniques vary both in algorithmic terms as well as
the underlying definition of cortical thickness.  An early, foundational technique is the 
method of \cite{jones2000} in which the inner and outer surface geometry is used to determine the
solution to Laplace's equation where thickness is measured by integrating along the 
tangents of the resulting field lines spanning the boundary surfaces.  Subsequent contributions
improved upon the original formulation.  For example, in \cite{yezzi2003}, an Eulerian PDE approach
was proposed to facilitate the computation of correspondence paths.  Extending the surface-based
work of \cite{macdonald2000}, the hybrid approach of
\cite{kim2005} uses the discrete Laplacian field to deform the white matter surface mesh towards the 
pial surface.    Although the Laplacian-based approach has several advantages
including generally lower computational times and 
non-crossing correspondence paths, direct correlative assessments with histology
are potentially problematic as the quantified distances 
are not necessarily Euclidean.  Other volumetric algorithms employ coupled
level sets \citep{zeng1999}, model-free intelligent search strategies either normal to 
the gray-white matter interface \citep{scott2009}, or using a min-max rule \citep{clement-vachet2011}.
Most relevant to this work is the DiReCT (Diffeomorphic Registration-based 
Cortical Thickness) algorithm proposed in \cite{das2009} where generated
diffeomorphic mappings between the 
white and pial matter surfaces are used to propagate thickness values 
through the cortical gray matter.  A unique benefit of DiReCT is that it
naturally estimates the boundaries of buried sulci by employing a
diffeomorphic constraint on the probabilistic estimate of the gray
matter and cerebrospinal fluid interface.  

Although a variety of techniques exist for estimating cortical thickness
from imaging data (of which only a fraction are cited), several common preprocessing components
can be identified.  The most fundamental of these include inhomogeneity correction, skull stripping, and $n$-tissue segmentation for differentiating the gray and white matters.  For statistical analysis 
across large populations, construction of population-specific unbiased templates
is also potentially beneficial \citep{evans2012}.
In addition, intermediate steps might include a crucial registration component (e.g. 
propagating template-based tissue priors for improved segmentation).

Also increasing the complexity of cortical thickness studies is
the need for large neuroimaging datasets such as that provided by the Alzheimer's
Disease Neuroimaging Initiative (ADNI) and the increasing importance
of fully automated and multiple modality brain mapping tools
\citep{Weiner2012}.  In the case of ADNI, the scale of such datasets is projected
to increase over time as international projects join the effort to build
large-scale AD-related neuroimaging resources.  Currently, the
National Institutes of Health (NIH) also mandates that any NIH-funded data
resources, including MRI, must be released to the public.  In contrast
to ADNI, which provides standardized data acquisition protocols used
across all sites, these smaller-scale projects are collected in an
unstructured way.  Therefore, neuroimage processing tools must
reliably quantify even when there is a relative lack of quality
control over the input data.  While robustness is a goal shared by all
software development targeted at neuroscience research, very few methods have
been thoroughly tested on large and unstructured neuroimaging datasets.


The general lack of availability of published
algorithms \citep{kovacevic2006} (not to mention critical preprocessing
components) inhibits performing studies by external researchers 
and makes comparative evaluations difficult.  For example, one recent evaluation 
study \citep{clarkson2011} compared
FreeSurfer (a surface-based method) with two volumetric methods \citep{jones2000,das2009}.
Whereas the entire FreeSurfer processing pipeline has been made publicly available, 
refined by the original authors and other contributors, and described in great detail 
(specifically in terms of suggested parameters); both volumetric methods were 
implemented solely by the authors of the evaluation (not the actual algorithm developers) 
using unspecified parameters with relatively small, private data sets
making the comparisons less than ideal (see \cite{tustison2013} for further discussion 
concerning the issue of instrumentation bias and scientific reproducibility in the use and evaluation of software). Further complicating comparisons are distinct 
processing domains between volumetric and surface-based techniques and the potential for the introduction of bias \citep{klein2010}.

A brief description of our proposed pipeline, which produces a volumetric
cortical thickness map from an individual subject's T1-weighted MRI, is provided.  
Additionally, we note that it is freely available as part of the Advanced Normalization Tools
(ANTs) software package.  This includes all the necessary preprocessing steps consisting
of well-vetted, previously published algorithms for bias correction \citep{tustison2010},
brain extraction \citep{avants2010a}, $n$-tissue segmentation \citep{avants2011a},
template construction \citep{avants2010}, and image normalization \citep{avants2011}.
More important, however, we provide explicit coordination between
these components within a set of well-documented shell scripts which 
are also available in the ANTs repository where parameters have been tuned
by ANTs developers (N.T. and B.A.).  A fully functional 2-D example is provided
at the github repository associated with this work.%
\footnote{
http://www.github.com/KapowskiChronicles/
}

In this work, we demonstrate the use of the described framework 
in processing a large 
cohort of publicly available T1-weighted brain MRI data drawn from 
four well-known data sets totaling approximately 1200 images.  For
comparative evaluation we also process the same data using the 
standard FreeSurfer cortical thickness processing protocol.  Using 
data subsets of repeated acquisitions, repeatability measures
for both frameworks are reported as in previous work 
\citep{clarkson2011,jovicich2013}.  However, as repeatability (or, more generally, {\it precision})
is not conceptually equivalent to {\it accuracy}, and given that ground-truth
measurements are not available for these data, we use demographic-based
predictive assessments to show that ANTs outperforms FreeSurfer-based
thickness estimation for these data in well-studied cortical thickness 
and age/gender relationships.

Finally, we make available all data from both ANTs and FreeSurfer 
processing outcomes.  This includes derived image data, processing scripts, 
and tabulated results.  The availability of both the code and data permits
the set of results described in this work to be fully reproducible.  This
permits other researchers to contrast their own results against
this baseline processing and to adapt the given volumetric pipeline for measuring
cortical thickness with their own datasets.  



